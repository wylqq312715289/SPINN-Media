Using TensorFlow backend.
2017-10-24 18:01:47.326060: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.
2017-10-24 18:01:47.326124: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.
2017-10-24 18:01:47.326131: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.
2017-10-24 18:01:47.326136: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.
2017-10-24 18:01:47.326141: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.
2017-10-24 18:01:53.586322: I tensorflow/core/common_runtime/gpu/gpu_device.cc:940] Found device 0 with properties: 
name: Tesla K80
major: 3 minor: 7 memoryClockRate (GHz) 0.8235
pciBusID 0000:04:00.0
Total memory: 11.17GiB
Free memory: 11.10GiB
2017-10-24 18:01:53.586595: I tensorflow/core/common_runtime/gpu/gpu_device.cc:961] DMA: 0 
2017-10-24 18:01:53.586604: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971] 0:   Y 
2017-10-24 18:01:53.586618: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0)
('readH5 Feature.shape=', (91192, 64, 64))
('readH5 Feature.shape=', (91192, 64, 64))
begin to over_sampling ......
end over_sampling, pos/nag=0.249993,pos_nag_rato=0.250000
begin to over_sampling ......
end over_sampling, pos/nag=0.249972,pos_nag_rato=0.250000
train_model in MedlatModel ......
train pos num = 18000, train nag num = 72002
vali pos num = 4498, vali nag num = 17994
Remove file ./cache/models/cnn_model_1.h5.
Train on 90002 samples, validate on 22492 samples
Epoch 1/5
212s - loss: 0.0760 - acc: 0.9700 - val_loss: 0.0546 - val_acc: 0.9795
Epoch 2/5
201s - loss: 0.0421 - acc: 0.9855 - val_loss: 0.0509 - val_acc: 0.9816
Epoch 3/5
200s - loss: 0.0323 - acc: 0.9900 - val_loss: 0.0576 - val_acc: 0.9777
Epoch 4/5
200s - loss: 0.0246 - acc: 0.9934 - val_loss: 0.0528 - val_acc: 0.9835
Epoch 5/5
199s - loss: 0.0195 - acc: 0.9950 - val_loss: 0.0644 - val_acc: 0.9780
confusion matrix: 
[[17886   108]
 [  386  4112]]
accuracy score:  0.978036635248
classification report:
             precision    recall  f1-score   support

          0       0.98      0.99      0.99     17994
          1       0.97      0.91      0.94      4498

avg / total       0.98      0.98      0.98     22492

F1 score:  0.943335627437
recall:  0.914184081814
False positive rate:  0.00600200066689
********************  1 fold end  ********************
begin to over_sampling ......
end over_sampling, pos/nag=0.249993,pos_nag_rato=0.250000
begin to over_sampling ......
end over_sampling, pos/nag=0.249972,pos_nag_rato=0.250000
train_model in MedlatModel ......
train pos num = 18003, train nag num = 72014
vali pos num = 4495, vali nag num = 17982
Remove file ./cache/models/cnn_model_2.h5.
Train on 90017 samples, validate on 22477 samples
Epoch 1/5
202s - loss: 0.0853 - acc: 0.9649 - val_loss: 0.0727 - val_acc: 0.9766
Epoch 2/5
200s - loss: 0.0434 - acc: 0.9857 - val_loss: 0.0706 - val_acc: 0.9746
Epoch 3/5
199s - loss: 0.0343 - acc: 0.9895 - val_loss: 0.0711 - val_acc: 0.9772
Epoch 4/5
199s - loss: 0.0279 - acc: 0.9921 - val_loss: 0.1059 - val_acc: 0.9659
Epoch 5/5
198s - loss: 0.0244 - acc: 0.9934 - val_loss: 0.0939 - val_acc: 0.9715
confusion matrix: 
[[17864   118]
 [  523  3972]]
accuracy score:  0.971481959336
classification report:
             precision    recall  f1-score   support

          0       0.97      0.99      0.98     17982
          1       0.97      0.88      0.93      4495

avg / total       0.97      0.97      0.97     22477

F1 score:  0.92533488643
recall:  0.883648498331
False positive rate:  0.00656211767323
********************  2 fold end  ********************
begin to over_sampling ......
end over_sampling, pos/nag=0.250000,pos_nag_rato=0.250000
begin to over_sampling ......
end over_sampling, pos/nag=0.250000,pos_nag_rato=0.250000
train_model in MedlatModel ......
train pos num = 17998, train nag num = 71992
vali pos num = 4501, vali nag num = 18004
Remove file ./cache/models/cnn_model_3.h5.
Train on 89990 samples, validate on 22505 samples
Epoch 1/5
202s - loss: 0.0716 - acc: 0.9758 - val_loss: 0.0529 - val_acc: 0.9820
Epoch 2/5
200s - loss: 0.0402 - acc: 0.9868 - val_loss: 0.0543 - val_acc: 0.9840
Epoch 3/5
200s - loss: 0.0291 - acc: 0.9920 - val_loss: 0.0514 - val_acc: 0.9818
Epoch 4/5
199s - loss: 0.0209 - acc: 0.9952 - val_loss: 0.0665 - val_acc: 0.9757
Epoch 5/5
198s - loss: 0.0168 - acc: 0.9961 - val_loss: 0.0720 - val_acc: 0.9788
confusion matrix: 
[[17911    93]
 [  383  4118]]
accuracy score:  0.978849144635
classification report:
             precision    recall  f1-score   support

          0       0.98      0.99      0.99     18004
          1       0.98      0.91      0.95      4501

avg / total       0.98      0.98      0.98     22505

F1 score:  0.94536271809
recall:  0.914907798267
False positive rate:  0.00516551877361
********************  3 fold end  ********************
begin to over_sampling ......
end over_sampling, pos/nag=0.249993,pos_nag_rato=0.250000
begin to over_sampling ......
end over_sampling, pos/nag=0.249972,pos_nag_rato=0.250000
train_model in MedlatModel ......
train pos num = 17993, train nag num = 71974
vali pos num = 4505, vali nag num = 18022
Remove file ./cache/models/cnn_model_4.h5.
Train on 89967 samples, validate on 22527 samples
Epoch 1/5
202s - loss: 0.1924 - acc: 0.9484 - val_loss: 0.1608 - val_acc: 0.9818
Epoch 2/5
198s - loss: 0.1577 - acc: 0.9785 - val_loss: 0.1517 - val_acc: 0.9783
Epoch 3/5
198s - loss: 0.1497 - acc: 0.9814 - val_loss: 0.1477 - val_acc: 0.9798
Epoch 4/5
197s - loss: 0.1431 - acc: 0.9843 - val_loss: 0.1501 - val_acc: 0.9736
Epoch 5/5
197s - loss: 0.1377 - acc: 0.9863 - val_loss: 0.1440 - val_acc: 0.9814
confusion matrix: 
[[17855   167]
 [  252  4253]]
accuracy score:  0.981400097661
classification report:
             precision    recall  f1-score   support

          0       0.99      0.99      0.99     18022
          1       0.96      0.94      0.95      4505

avg / total       0.98      0.98      0.98     22527

F1 score:  0.953053221289
recall:  0.944062153163
False positive rate:  0.00926645211408
********************  4 fold end  ********************
begin to over_sampling ......
end over_sampling, pos/nag=0.249993,pos_nag_rato=0.250000
begin to over_sampling ......
end over_sampling, pos/nag=0.249972,pos_nag_rato=0.250000
train_model in MedlatModel ......
train pos num = 18000, train nag num = 72002
vali pos num = 4498, vali nag num = 17994
Remove file ./cache/models/cnn_model_5.h5.
Train on 90002 samples, validate on 22492 samples
Epoch 1/5
200s - loss: 0.0697 - acc: 0.9729 - val_loss: 0.0579 - val_acc: 0.9796
Epoch 2/5
200s - loss: 0.0428 - acc: 0.9848 - val_loss: 0.0632 - val_acc: 0.9763
Epoch 3/5
199s - loss: 0.0333 - acc: 0.9895 - val_loss: 0.0727 - val_acc: 0.9752
Epoch 4/5
199s - loss: 0.0266 - acc: 0.9924 - val_loss: 0.0929 - val_acc: 0.9734
Epoch 5/5
199s - loss: 0.0197 - acc: 0.9949 - val_loss: 0.0931 - val_acc: 0.9739
confusion matrix: 
[[17888   106]
 [  482  4016]]
accuracy score:  0.97385737151
classification report:
             precision    recall  f1-score   support

          0       0.97      0.99      0.98     17994
          1       0.97      0.89      0.93      4498

avg / total       0.97      0.97      0.97     22492

F1 score:  0.931786542923
recall:  0.892841262783
False positive rate:  0.00589085250639
********************  5 fold end  ********************
./cache/evaluate.csv had saved. Please download it.
confusion matrix: 
[[89404   592]
 [ 2026 20471]]
accuracy score:  0.976727440819
classification report:
             precision    recall  f1-score   support

          0       0.98      0.99      0.99     89996
          1       0.97      0.91      0.94     22497

avg / total       0.98      0.98      0.98    112493

F1 score:  0.939898989899
recall:  0.909943548029
False positive rate:  0.00657807013645
