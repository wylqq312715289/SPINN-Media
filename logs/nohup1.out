Using TensorFlow backend.
2017-10-24 15:04:33.985683: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.
2017-10-24 15:04:33.985747: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.
2017-10-24 15:04:33.985755: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.
2017-10-24 15:04:33.985760: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.
2017-10-24 15:04:33.985765: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.
2017-10-24 15:04:40.121462: I tensorflow/core/common_runtime/gpu/gpu_device.cc:940] Found device 0 with properties: 
name: Tesla K80
major: 3 minor: 7 memoryClockRate (GHz) 0.8235
pciBusID 0000:04:00.0
Total memory: 11.17GiB
Free memory: 11.10GiB
2017-10-24 15:04:40.121515: I tensorflow/core/common_runtime/gpu/gpu_device.cc:961] DMA: 0 
2017-10-24 15:04:40.121522: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971] 0:   Y 
2017-10-24 15:04:40.121537: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0)
('readH5 Feature.shape=', (91192, 64, 64))
('readH5 Feature.shape=', (91192, 64, 64))
begin to over_sampling ......
end over_sampling, pos/nag=0.249993,pos_nag_rato=0.250000
train_model in MedlatModel ......
train pos num = 18000, train nag num = 72002
vali pos num = 245, vali nag num = 17994
Remove file ./cache/models/cnn_model_1.h5.
Train on 90002 samples, validate on 18239 samples
Epoch 1/10
204s - loss: 0.5838 - acc: 0.9627 - val_loss: 0.6794 - val_acc: 0.9851
Epoch 2/10
194s - loss: 0.5616 - acc: 0.9783 - val_loss: 0.6638 - val_acc: 0.9833
Epoch 3/10
194s - loss: 0.5453 - acc: 0.9814 - val_loss: 0.6491 - val_acc: 0.9840
Epoch 4/10
194s - loss: 0.5304 - acc: 0.9829 - val_loss: 0.6326 - val_acc: 0.9852
Epoch 5/10
194s - loss: 0.5165 - acc: 0.9839 - val_loss: 0.6173 - val_acc: 0.9872
Epoch 6/10
193s - loss: 0.5031 - acc: 0.9849 - val_loss: 0.6017 - val_acc: 0.9861
Epoch 7/10
194s - loss: 0.4902 - acc: 0.9859 - val_loss: 0.5947 - val_acc: 0.9845
Epoch 8/10
194s - loss: 0.4784 - acc: 0.9858 - val_loss: 0.5709 - val_acc: 0.9899
Epoch 9/10
193s - loss: 0.4660 - acc: 0.9870 - val_loss: 0.5668 - val_acc: 0.9863
Epoch 10/10
193s - loss: 0.4539 - acc: 0.9879 - val_loss: 0.5493 - val_acc: 0.9877
confusion matrix: 
[[17781   213]
 [   12   233]]
accuracy score:  0.987663797357
classification report:
             precision    recall  f1-score   support

          0       1.00      0.99      0.99     17994
          1       0.52      0.95      0.67       245

avg / total       0.99      0.99      0.99     18239

F1 score:  0.674384949349
recall:  0.951020408163
False positive rate:  0.011837279093
********************  1 fold end  ********************
begin to over_sampling ......
end over_sampling, pos/nag=0.249993,pos_nag_rato=0.250000
train_model in MedlatModel ......
train pos num = 18003, train nag num = 72014
vali pos num = 257, vali nag num = 17982
Remove file ./cache/models/cnn_model_2.h5.
Train on 90017 samples, validate on 18239 samples
Epoch 1/10
199s - loss: 0.0642 - acc: 0.9765 - val_loss: 0.0302 - val_acc: 0.9893
Epoch 2/10
198s - loss: 0.0311 - acc: 0.9908 - val_loss: 0.0222 - val_acc: 0.9923
Epoch 3/10
197s - loss: 0.0209 - acc: 0.9944 - val_loss: 0.0231 - val_acc: 0.9925
Epoch 4/10
196s - loss: 0.0154 - acc: 0.9963 - val_loss: 0.0212 - val_acc: 0.9930
Epoch 5/10
196s - loss: 0.0113 - acc: 0.9973 - val_loss: 0.0232 - val_acc: 0.9934
Epoch 6/10
195s - loss: 0.0087 - acc: 0.9980 - val_loss: 0.0216 - val_acc: 0.9940
Epoch 7/10
195s - loss: 0.0066 - acc: 0.9984 - val_loss: 0.0246 - val_acc: 0.9936
Epoch 8/10
195s - loss: 0.0047 - acc: 0.9990 - val_loss: 0.0239 - val_acc: 0.9939
Epoch 9/10
195s - loss: 0.0034 - acc: 0.9993 - val_loss: 0.0273 - val_acc: 0.9935
Epoch 10/10
194s - loss: 0.0025 - acc: 0.9996 - val_loss: 0.0297 - val_acc: 0.9940
confusion matrix: 
[[17915    67]
 [   42   215]]
accuracy score:  0.994023795164
classification report:
             precision    recall  f1-score   support

          0       1.00      1.00      1.00     17982
          1       0.76      0.84      0.80       257

avg / total       0.99      0.99      0.99     18239

F1 score:  0.797773654917
recall:  0.836575875486
False positive rate:  0.00372594817039
********************  2 fold end  ********************
begin to over_sampling ......
end over_sampling, pos/nag=0.250000,pos_nag_rato=0.250000
train_model in MedlatModel ......
train pos num = 17998, train nag num = 71992
vali pos num = 234, vali nag num = 18004
Remove file ./cache/models/cnn_model_3.h5.
Train on 89990 samples, validate on 18238 samples
Epoch 1/10
200s - loss: 0.0679 - acc: 0.9749 - val_loss: 0.0308 - val_acc: 0.9886
Epoch 2/10
198s - loss: 0.0380 - acc: 0.9871 - val_loss: 0.0313 - val_acc: 0.9896
Epoch 3/10
197s - loss: 0.0267 - acc: 0.9921 - val_loss: 0.0204 - val_acc: 0.9930
Epoch 4/10
196s - loss: 0.0199 - acc: 0.9947 - val_loss: 0.0197 - val_acc: 0.9936
Epoch 5/10
196s - loss: 0.0149 - acc: 0.9960 - val_loss: 0.0204 - val_acc: 0.9934
Epoch 6/10
195s - loss: 0.0112 - acc: 0.9973 - val_loss: 0.0163 - val_acc: 0.9951
Epoch 7/10
195s - loss: 0.0091 - acc: 0.9979 - val_loss: 0.0240 - val_acc: 0.9931
Epoch 8/10
195s - loss: 0.0071 - acc: 0.9984 - val_loss: 0.0196 - val_acc: 0.9948
Epoch 9/10
195s - loss: 0.0058 - acc: 0.9987 - val_loss: 0.0198 - val_acc: 0.9945
Epoch 10/10
194s - loss: 0.0043 - acc: 0.9991 - val_loss: 0.0206 - val_acc: 0.9948
confusion matrix: 
[[17939    65]
 [   29   205]]
accuracy score:  0.994845926088
classification report:
             precision    recall  f1-score   support

          0       1.00      1.00      1.00     18004
          1       0.76      0.88      0.81       234

avg / total       1.00      0.99      1.00     18238

F1 score:  0.813492063492
recall:  0.876068376068
False positive rate:  0.00361030882026
********************  3 fold end  ********************
begin to over_sampling ......
end over_sampling, pos/nag=0.249993,pos_nag_rato=0.250000
train_model in MedlatModel ......
train pos num = 17993, train nag num = 71974
vali pos num = 216, vali nag num = 18022
Remove file ./cache/models/cnn_model_4.h5.
Train on 89967 samples, validate on 18238 samples
Epoch 1/10
198s - loss: 0.0730 - acc: 0.9724 - val_loss: 0.0264 - val_acc: 0.9909
Epoch 2/10
197s - loss: 0.0415 - acc: 0.9866 - val_loss: 0.0307 - val_acc: 0.9899
Epoch 3/10
196s - loss: 0.0295 - acc: 0.9918 - val_loss: 0.0195 - val_acc: 0.9930
Epoch 4/10
195s - loss: 0.0210 - acc: 0.9949 - val_loss: 0.0233 - val_acc: 0.9918
Epoch 5/10
195s - loss: 0.0167 - acc: 0.9960 - val_loss: 0.0218 - val_acc: 0.9930
Epoch 6/10
194s - loss: 0.0134 - acc: 0.9969 - val_loss: 0.0194 - val_acc: 0.9938
Epoch 7/10
194s - loss: 0.0109 - acc: 0.9974 - val_loss: 0.0195 - val_acc: 0.9943
Epoch 8/10
193s - loss: 0.0086 - acc: 0.9982 - val_loss: 0.0215 - val_acc: 0.9941
Epoch 9/10
193s - loss: 0.0074 - acc: 0.9984 - val_loss: 0.0203 - val_acc: 0.9944
Epoch 10/10
193s - loss: 0.0060 - acc: 0.9986 - val_loss: 0.0221 - val_acc: 0.9939
confusion matrix: 
[[17937    85]
 [   26   190]]
accuracy score:  0.993913806338
classification report:
             precision    recall  f1-score   support

          0       1.00      1.00      1.00     18022
          1       0.69      0.88      0.77       216

avg / total       0.99      0.99      0.99     18238

F1 score:  0.773930753564
recall:  0.87962962963
False positive rate:  0.00471645766286
********************  4 fold end  ********************
begin to over_sampling ......
end over_sampling, pos/nag=0.249993,pos_nag_rato=0.250000
train_model in MedlatModel ......
train pos num = 18000, train nag num = 72002
vali pos num = 244, vali nag num = 17994
Remove file ./cache/models/cnn_model_5.h5.
Train on 90002 samples, validate on 18238 samples
Epoch 1/10
196s - loss: 0.0709 - acc: 0.9741 - val_loss: 0.0329 - val_acc: 0.9895
Epoch 2/10
196s - loss: 0.0420 - acc: 0.9862 - val_loss: 0.0273 - val_acc: 0.9912
Epoch 3/10
196s - loss: 0.0323 - acc: 0.9901 - val_loss: 0.0254 - val_acc: 0.9914
Epoch 4/10
196s - loss: 0.0246 - acc: 0.9932 - val_loss: 0.0286 - val_acc: 0.9913
Epoch 5/10
194s - loss: 0.0197 - acc: 0.9948 - val_loss: 0.0241 - val_acc: 0.9923
Epoch 6/10
194s - loss: 0.0156 - acc: 0.9961 - val_loss: 0.0237 - val_acc: 0.9931
Epoch 7/10
194s - loss: 0.0130 - acc: 0.9968 - val_loss: 0.0241 - val_acc: 0.9934
Epoch 8/10
193s - loss: 0.0111 - acc: 0.9973 - val_loss: 0.0302 - val_acc: 0.9919
Epoch 9/10
193s - loss: 0.0099 - acc: 0.9976 - val_loss: 0.0264 - val_acc: 0.9932
Epoch 10/10
193s - loss: 0.0074 - acc: 0.9982 - val_loss: 0.0266 - val_acc: 0.9927
confusion matrix: 
[[17897    97]
 [   36   208]]
accuracy score:  0.992707533721
classification report:
             precision    recall  f1-score   support

          0       1.00      0.99      1.00     17994
          1       0.68      0.85      0.76       244

avg / total       0.99      0.99      0.99     18238

F1 score:  0.757741347905
recall:  0.852459016393
False positive rate:  0.00539068578415
********************  5 fold end  ********************
./cache/evaluate.csv had saved. Please download it.
confusion matrix: 
[[89469   527]
 [  145  1051]]
accuracy score:  0.992630932538
classification report:
             precision    recall  f1-score   support

          0       1.00      0.99      1.00     89996
          1       0.67      0.88      0.76      1196

avg / total       0.99      0.99      0.99     91192

F1 score:  0.757750540735
recall:  0.878762541806
False positive rate:  0.00585581581404
